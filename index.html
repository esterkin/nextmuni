<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="nextmuni.css">
    <link rel="stylesheet" href="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.css" />
    <title>SF MUNI Predictions</title>
    <script src="http://code.jquery.com/jquery-1.10.2.js"></script>
    <script src="http://cdn.leafletjs.com/leaflet-0.7.2/leaflet.js"></script>
    <script src="nextmuni.js"></script>
    <script>
        $(document).ready(function () {

            $("#stops").change(function(e){
               updateURL(); 
            });

            $("#routes, #directions").change(function(e){
                updateURL(true);
            });
                
            loadRoutes(nextBusURL,agency);

            $("#routes").change(function () {
                routeSelected = $('#routes').val();
                $("#stops").empty();
                $("#directions").empty();
                loadDirectionsAndStops(routeSelected,listDirections);
            });

            $("#directions").change(function () {
                $("#stops").empty();
                listStops(xmldata);
            });

            $("#stops").change(function () {
                stopTagSelected = $('#stops').val();
                loadPredictions();
                setLatLon();
            });

            setInterval(loadPredictions, 10000); //update predictions every 10 seconds

            initializeMap();
            getLocation();

        });
    </script>
</head>

<body>
    <div id="content">

        <div id='leftpane'>
            <ul id='userinput'>
                <li>
                    <div id="selectbox">
                    Route
                    <select id='routes'></select>
                    </div>
                </li>
                <li>
                    <div id="selectbox">
                        Direction
                        <select id='directions'></select>
                     </div>
                </li>
                <li>
                    <div class="selectbox">
                        Stop
                        <select id='stops'></select>
                     </div>
                </li>
            </ul>
            <ul id='predictions'>
            </ul>
            </ul>
            <ul id='nearbystops'>
                <p id='nearbystopstitle'></p>
            </ul>
        </div>

        <div id='mapcontainer'>
            <div id='map'></div>
        </div>

    </div>

    <div id='footer'></div>
</body>

</html>
